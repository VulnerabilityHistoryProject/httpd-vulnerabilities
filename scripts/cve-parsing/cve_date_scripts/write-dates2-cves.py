import sys, csv

# reads in a manifest file [cve name, cve published date]
def read_cve_manifest(cve_manifest):
    with open(cve_manifest, 'r') as cve_manifest_file:
        # reads in each line of cve manifest file
        file_reader = csv.reader(cve_manifest_file, delimiter=',')
        for row in file_reader:
            #print(row)
            filename = str(row[0])
            publishedDate = str(row[1])
            print("Filename: " + filename + "\n" + "Published Date: " + publishedDate)
            cve_file = open("../../cves/"+filename, 'r')
            output_file = open("../../new_cves/"+filename, 'w')
            fileLine = cve_file.readline()
            while fileLine:      
                if fileLine == "announced:\n":
                    output_file.write("announced: " + publishedDate + "\n")
                    print("Filename: " + filename)
                    print("Published Date: " + publishedDate)
                else:
                    output_file.write(fileLine)
                fileLine = cve_file.readline()
            output_file.close()
            
def main():
    read_cve_manifest(str(sys.argv[1]))

if __name__ == "__main__":
    main() 
